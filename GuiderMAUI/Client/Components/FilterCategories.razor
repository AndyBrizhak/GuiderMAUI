@using Microsoft.Maui.Devices

<div class="categories-container">
    @* Добавляем динамический класс: mobile-mode или desktop-mode *@
    <div class="scroll-wrapper @scrollClass">
        
        @* 1. Кнопка ALL (Все) *@
        <button type="button" 
                class="cat-chip @(string.IsNullOrEmpty(SelectedCategory) ? "active" : "")"
                @onclick="SelectAll">
            <span>All</span>
        </button>

        @* 2. Категории *@
        @foreach (var cat in categories)
        {
            <button type="button" 
                    class="cat-chip @(IsSelected(cat.Id) ? "active" : "")"
                    @onclick="() => SelectCategory(cat.Id)">
                <span class="icon">@cat.Icon</span>
                <span>@cat.Name</span>
            </button>
        }
    </div>
</div>

@code {
    [Parameter] public string? SelectedCategory { get; set; }
    [Parameter] public EventCallback<string?> OnCategoryChanged { get; set; }

    // Определяем платформу: если Windows -> desktop-mode, иначе -> mobile-mode
    private string scrollClass => DeviceInfo.Platform == DevicePlatform.WinUI ? "desktop-mode" : "mobile-mode";

    // Ваши категории (как в Blazor)
    private List<(string Id, string Name, string Icon)> categories = new()
    {
        ("services",   "Services",   "🛠️"),
        ("to-eat",     "Foods",      "🍔"),
        ("adventures", "Adventures", "🏄"),
        ("shops",      "Shopping",   "🛍️")
    };

    private bool IsSelected(string catId) 
    {
        return string.Equals(SelectedCategory, catId, StringComparison.OrdinalIgnoreCase);
    }

    private async Task SelectAll()
    {
        if (!string.IsNullOrEmpty(SelectedCategory))
        {
            await OnCategoryChanged.InvokeAsync(null);
        }
    }

    private async Task SelectCategory(string catId)
    {
        // Клик по активной -> сброс. Клик по новой -> выбор.
        if (IsSelected(catId))
        {
            await OnCategoryChanged.InvokeAsync(null);
        }
        else
        {
            await OnCategoryChanged.InvokeAsync(catId);
        }
    }
}